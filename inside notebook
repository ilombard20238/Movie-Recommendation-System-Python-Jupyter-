import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity

movies = pd.read_csv("data/movies.csv")
tfidf = TfidfVectorizer(stop_words="english")
matrix = tfidf.fit_transform(movies["description"].fillna(""))

cosine_sim = cosine_similarity(matrix, matrix)

def recommend(title, n=5):
    idx = movies[movies["title"] == title].index[0]
    scores = list(enumerate(cosine_sim[idx]))
    scores = sorted(scores, key=lambda x: x[1], reverse=True)[1:n+1]
    recs = [movies.iloc[i[0]]["title"] for i in scores]
    return recs

print(recommend("The Matrix"))
